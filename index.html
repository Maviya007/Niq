
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NIQ Enterprise Customer Experience Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<style>
/* ================= NIQ ENTERPRISE DESIGN SYSTEM ================= */
:root {
  --niq-blue: #003a8f;
  --niq-blue-2: #2c7be5;
  --niq-dark: #0f2a44;
  --niq-bg: #f4f7fa;
  --niq-white: #ffffff;
  --niq-border: rgba(0,58,143,0.18);
  --niq-muted: #6b7280;
  --niq-shadow: rgba(0,58,143,0.12);
  --niq-glass: rgba(255,255,255,0.72);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Inter', sans-serif;
  background: var(--niq-bg);
  color: var(--niq-dark);
  min-height: 100vh;
  overflow-x: hidden;
}

/* ================= BACKGROUND ================= */
.background-layer {
  position: fixed;
  inset: 0;
  z-index: 0;
  background: linear-gradient(180deg, #ffffff 0%, #f4f7fa 100%);
}
.background-layer::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(transparent 95%, rgba(0,58,143,0.04) 95%),
    linear-gradient(90deg, transparent 95%, rgba(0,58,143,0.04) 95%);
  background-size: 64px 64px;
}

.bubble {
  position: absolute;
  border-radius: 50%;
  opacity: 0.05;
  animation: float linear infinite;
}
.bubble.dark { background: var(--niq-blue); }
.bubble.light { background: var(--niq-blue-2); }

@keyframes float {
  0% { transform: translateY(120vh) translateX(0); }
  100% { transform: translateY(-130vh) translateX(120px); }
}

/* ================= LAYOUT ================= */
.app-layout {
  position: relative;
  z-index: 1;
  display: grid;
  grid-template-columns: 260px 1fr 340px;
  min-height: 100vh;
}

.brand-panel {
  background: linear-gradient(180deg, var(--niq-dark), var(--niq-blue));
  color: white;
  padding: 2rem 1.6rem;
  display: flex;
  flex-direction: column;
  border-right: 2px solid var(--niq-border);
}
.brand-logo { font-size: 2.4rem; font-weight: 800; letter-spacing: -1.5px; margin-bottom: 2rem; }
.brand-title { font-size: 1.15rem; font-weight: 600; margin-bottom: 0.5rem; }
.brand-subtitle { font-size: 0.92rem; opacity: 0.75; line-height: 1.5; }
.brand-footer { margin-top: auto; font-size: 0.8rem; opacity: 0.6; }

.survey-panel { padding: 3rem 3.2rem; display: flex; flex-direction: column; }

.survey-card {
  background: var(--niq-glass);
  backdrop-filter: blur(16px);
  border: 2px solid var(--niq-border);
  box-shadow: 0 28px 70px var(--niq-shadow);
  padding: 2.6rem 2.8rem;
}

.survey-title { font-size: 2rem; font-weight: 700; margin-bottom: 0.3rem; }
.survey-desc { font-size: 1rem; color: var(--niq-muted); }

/* ================= PROGRESS ================= */
.progress-wrap { margin: 1.4rem 0 2rem; }
.progress-bar { height: 6px; background: rgba(0,58,143,0.12); }
.progress-fill { height: 100%; width: 25%; background: linear-gradient(90deg, var(--niq-blue), var(--niq-blue-2)); transition: width 0.4s ease; }
.progress-steps { display: flex; justify-content: space-between; font-size: 0.8rem; margin-top: 0.6rem; color: var(--niq-muted); }

.step { display: none; }
.step.active { display: block; }

.question { margin-bottom: 2rem; }
.question-title { font-size: 1.05rem; font-weight: 600; margin-bottom: 0.25rem; }
.question-desc { font-size: 0.9rem; color: var(--niq-muted); margin-bottom: 1.1rem; }

/* ================= NPS ================= */
.nps-scale { display: grid; grid-template-columns: repeat(11, 1fr); gap: 0.45rem; }
.nps-item {
  padding: 0.65rem 0;
  text-align: center;
  border: 2px solid var(--niq-blue);
  cursor: pointer;
  transition: 0.2s ease;
  font-size: 0.85rem;
  font-weight: 600;
  background: white;
}
.nps-item:hover { background: #e6f0ff; }
.nps-item.selected { background: var(--niq-blue); color: white; }
.nps-labels { display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--niq-muted); margin-top: 0.5rem; }

/* ================= ULTRA CORPORATE EMOJI SYSTEM ================= */
.emoji-row {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 0.6rem;
}

.emoji-box {
  border: 2px solid var(--niq-border);
  background: white;
  padding: 0.9rem 0.6rem;
  text-align: center;
  cursor: pointer;
  transition: all 0.18s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.35rem;
}

.emoji-box:hover {
  border-color: var(--niq-blue);
  background: #f0f5ff;
}

.emoji-box.selected {
  border-color: var(--niq-blue);
  background: #e6f0ff;
  box-shadow: 0 6px 18px rgba(0,58,143,0.15);
}

/* corporate emoji icon style (google-like) */
.emoji-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 2px solid var(--niq-blue);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  color: var(--niq-blue);
  background: white;
  transition: transform 0.22s ease, background 0.22s ease, color 0.22s ease;
}

.emoji-box:hover .emoji-icon {
  transform: scale(1.06);
}

.emoji-box.selected .emoji-icon {
  background: var(--niq-blue);
  color: white;
  transform: scale(1.1);
}

.emoji-label {
  font-size: 0.78rem;
  font-weight: 600;
  letter-spacing: 0.25px;
  color: var(--niq-muted);
}

.emoji-box.selected .emoji-label { color: var(--niq-blue); }

/* ================= TEXTAREA ================= */
.textarea {
  width: 100%;
  min-height: 120px;
  border: 2px solid var(--niq-border);
  padding: 0.9rem;
  font-family: inherit;
  font-size: 0.95rem;
  resize: none;
  transition: 0.2s ease;
}
.textarea:focus { outline: none; border-color: var(--niq-blue); background: #f0f5ff; }

/* ================= BUTTONS ================= */
.nav-buttons { display: flex; justify-content: space-between; margin-top: 2rem; }
.btn {
  padding: 0.85rem 1.7rem;
  border: 2px solid var(--niq-blue);
  background: white;
  font-weight: 600;
  cursor: pointer;
  transition: 0.2s ease;
}
.btn.primary { background: linear-gradient(135deg, var(--niq-blue), var(--niq-blue-2)); color: white; }
.btn:hover { transform: translateY(-2px); }
.btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* ================= ANALYTICS PANEL ================= */
.analytics-panel {
  background: #f9fbff;
  border-left: 2px solid var(--niq-border);
  padding: 2.2rem 2rem;
}
.analytics-title { font-size: 1.15rem; font-weight: 700; margin-bottom: 1.3rem; }
.metric { margin-bottom: 1.4rem; }
.metric-label { font-size: 0.85rem; color: var(--niq-muted); }
.metric-value { font-size: 1.7rem; font-weight: 700; margin-top: 0.2rem; }

/* ================= WHEEL MODAL ================= */
.wheel-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15,42,68,0.65);
  backdrop-filter: blur(6px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999;
}
.wheel-overlay.active { display: flex; }

.wheel-modal {
  width: 680px;
  background: var(--niq-glass);
  backdrop-filter: blur(18px);
  border: 2px solid var(--niq-border);
  box-shadow: 0 30px 80px var(--niq-shadow);
  padding: 2rem 2.4rem;
  text-align: center;
}
.wheel-title { font-size: 1.4rem; font-weight: 700; margin-bottom: 0.4rem; }
.wheel-subtitle { font-size: 0.9rem; color: var(--niq-muted); margin-bottom: 1.4rem; }

.wrapper {
  position: relative;
  width: 420px;
  height: 420px;
  padding: 10px;
  background: white;
  border-radius: 50%;
  box-shadow: 0 20px 50px rgba(0,58,143,0.18);
  margin: 0 auto 1.2rem;
}

.pointer {
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 36px;
  height: 46px;
  z-index: 30;
}
.pointer svg { fill: #ff4d4f; }

canvas { width: 100%; height: 100%; }

.center-hub {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 82px;
  height: 82px;
  border-radius: 50%;
  background: white;
  border: 5px solid var(--niq-blue);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  color: var(--niq-blue);
  font-size: 22px;
  z-index: 20;
}

.wheel-btn {
  padding: 0.8rem 2.2rem;
  border: 2px solid var(--niq-blue);
  background: white;
  font-weight: 700;
  cursor: pointer;
  transition: 0.2s ease;
}
.wheel-btn.primary { background: linear-gradient(135deg, var(--niq-blue), var(--niq-blue-2)); color: white; }
.wheel-result { margin-top: 0.8rem; font-weight: 700; color: var(--niq-blue); }

@media (max-width: 1100px) {
  .app-layout { grid-template-columns: 220px 1fr; }
  .analytics-panel { display: none; }
}
@media (max-width: 700px) {
  .app-layout { grid-template-columns: 1fr; }
  .brand-panel { display: none; }
  .survey-panel { padding: 1.5rem; }
  .survey-card { padding: 1.8rem; }
  .wheel-modal { width: 92%; }
  .wrapper { width: 320px; height: 320px; }
}
</style>
</head>
<body>

<div class="background-layer">
  <div class="bubble dark" style="width:120px;height:120px;left:12%;animation-duration:30s;"></div>
  <div class="bubble light" style="width:80px;height:80px;left:35%;animation-duration:22s;"></div>
  <div class="bubble dark" style="width:150px;height:150px;left:62%;animation-duration:36s;"></div>
  <div class="bubble light" style="width:60px;height:60px;left:82%;animation-duration:18s;"></div>
</div>

<div class="app-layout">

  <aside class="brand-panel">
    <div class="brand-logo">NIQ</div>
    <div class="brand-title">Customer Experience</div>
    <div class="brand-subtitle">Enterprise feedback platform designed to improve service quality and decision-making.</div>
    <div class="brand-footer">NIQ Internal Systems </div>
  </aside>

  <main class="survey-panel">
    <div class="survey-card">

      <div class="survey-header">
        <div class="survey-title">Service Feedback Survey</div>
        <div class="survey-desc">Your feedback helps NIQ improve support quality and operational excellence.</div>
      </div>

      <div class="progress-wrap">
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div class="progress-steps">
          <span>NPS</span><span>Experience</span><span>Feedback</span><span>Submit</span>
        </div>
      </div>

      <div class="step active" data-step="1">
        <div class="question">
          <div class="question-title">How likely are you to recommend NIQ support to a colleague?</div>
          <div class="question-desc">0 = Not likely, 10 = Extremely likely</div>
          <div class="nps-scale" id="npsScale"></div>
          <div class="nps-labels"><span>Detractor</span><span>Promoter</span></div>
        </div>
      </div>

      <div class="step" data-step="2">
        <div class="question">
          <div class="question-title">Overall Experience</div>
          <div class="emoji-row" data-question="overall"></div>
        </div>
        <div class="question">
          <div class="question-title">Communication Quality</div>
          <div class="emoji-row" data-question="communication"></div>
        </div>
        <div class="question">
          <div class="question-title">Solution Accuracy</div>
          <div class="emoji-row" data-question="accuracy"></div>
        </div>
      </div>

      <div class="step" data-step="3">
        <div class="question">
          <div class="question-title">Additional Feedback</div>
          <div class="question-desc">Share suggestions or issues to help us improve.</div>
          <textarea class="textarea" id="textFeedback" placeholder="Type your feedback here..."></textarea>
        </div>
      </div>

      <div class="step" data-step="4">
        <div class="success-screen active">
          <div class="survey-title" style="color:var(--niq-blue)">Feedback Submitted</div>
          <div class="survey-desc">Thank you for contributing to NIQ service excellence.</div>
        </div>
      </div>

      <div class="nav-buttons">
        <button class="btn" id="prevBtn" disabled>Back</button>
        <button class="btn primary" id="nextBtn">Next</button>
      </div>

    </div>
  </main>

  <aside class="analytics-panel">
    <div class="analytics-title">Live Metrics</div>
    <div class="metric">
      <div class="metric-label">NPS Score</div>
      <div class="metric-value" id="metricNPS">-</div>
    </div>
    <div class="metric">
      <div class="metric-label">Experience Score</div>
      <div class="metric-value" id="metricExp">-</div>
    </div>
    <div class="metric">
      <div class="metric-label">Reward Points</div>
      <div class="metric-value" id="metricPoints">0</div>
    </div>
  </aside>

</div>

<div class="wheel-overlay" id="wheelOverlay">
  <div class="wheel-modal">
    <div class="wheel-title">NIQ Engagement Wheel</div>
    <div class="wheel-subtitle">One spin only â€¢ Earn reward points</div>

    <div class="wrapper">
      <div class="pointer">
        <svg viewBox="0 0 40 50"><path d="M20 50 L40 0 L0 0 Z"/></svg>
      </div>
      <canvas id="wheel" width="500" height="500"></canvas>
      <div class="center-hub">NIQ</div>
    </div>

    <button class="wheel-btn primary" id="spinBtn">SPIN WHEEL</button>
    <div class="wheel-result" id="result"></div>
  </div>
</div>

<script>
const state = { nps: null, ratings: {}, text: "" };
let currentStep = 1;
const totalSteps = 4;

const progressFill = document.getElementById('progressFill');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');

/* ===== NPS SCALE ===== */
const npsScale = document.getElementById('npsScale');
for (let i = 0; i <= 10; i++) {
  const div = document.createElement('div');
  div.className = 'nps-item';
  div.textContent = i;
  div.onclick = () => {
    document.querySelectorAll('.nps-item').forEach(el => el.classList.remove('selected'));
    div.classList.add('selected');
    state.nps = i;
    updateMetrics();
  };
  npsScale.appendChild(div);
}

/* ===== ULTRA CORPORATE EMOJIS (GOOGLE STYLE) ===== */
const emojiData = [
  { label: 'Poor', icon: 'ðŸ˜ž' },
  { label: 'Fair', icon: 'ðŸ˜' },
  { label: 'Good', icon: 'ðŸ™‚' },
  { label: 'Great', icon: 'ðŸ˜Š' },
  { label: 'Excellent', icon: 'ðŸ˜ƒ' }
];

document.querySelectorAll('.emoji-row').forEach(row => {
  emojiData.forEach((e, idx) => {
    const box = document.createElement('div');
    box.className = 'emoji-box';
    box.innerHTML = `<div class="emoji-icon">${e.icon}</div><div class="emoji-label">${e.label}</div>`;
    box.onclick = () => {
      row.querySelectorAll('.emoji-box').forEach(b => b.classList.remove('selected'));
      box.classList.add('selected');
      state.ratings[row.dataset.question] = idx + 1;
      updateMetrics();
    };
    row.appendChild(box);
  });
});

/* ===== STEP NAVIGATION ===== */
function showStep(step) {
  document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
  document.querySelector(`.step[data-step="${step}"]`).classList.add('active');
  progressFill.style.width = ((step - 1) / (totalSteps - 1)) * 100 + '%';
  prevBtn.disabled = step === 1;
  nextBtn.textContent = step === totalSteps ? 'Finish' : 'Next';
}

prevBtn.onclick = () => {
  if (currentStep > 1) { currentStep--; showStep(currentStep); }
};

nextBtn.onclick = () => {
  if (currentStep === 1 && state.nps === null) return alert('Please select NPS score');
  if (currentStep === 2 && Object.keys(state.ratings).length < 3) return alert('Please rate all categories');
  if (currentStep === 3) state.text = document.getElementById('textFeedback').value;

  if (currentStep < totalSteps) {
    currentStep++;
    showStep(currentStep);
  }

  if (currentStep === totalSteps) setTimeout(openWheel, 1200);
};

function updateMetrics() {
  document.getElementById('metricNPS').textContent = state.nps !== null ? state.nps : '-';
  const avg = Object.values(state.ratings).reduce((a,b)=>a+b,0) / (Object.keys(state.ratings).length || 1);
  document.getElementById('metricExp').textContent = avg ? avg.toFixed(1) : '-';
}

showStep(currentStep);

/* ===== WHEEL ENGINE ===== */
const wheelOverlay = document.getElementById('wheelOverlay');
const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');
const spinBtn = document.getElementById('spinBtn');
const resultBox = document.getElementById('result');

const items = [
  "150 Points", "650 Points ", "350 Points", "450 Points",
  "550 Points", "250 Points", "800 Points", "Better Luck"
];

const colors = ["#003a8f", "#f0f5ff", "#2c7be5", "#ffffff", "#002766", "#f0f5ff", "#096dd9", "#ffffff"];

let currentAngle = 0;
let isSpinning = false;
let lastTickIndex = -1;

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playTick() {
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = "sine";
  osc.frequency.setValueAtTime(150, audioCtx.currentTime);
  gain.gain.setValueAtTime(0.08, audioCtx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
  osc.connect(gain); gain.connect(audioCtx.destination);
  osc.start(); osc.stop(audioCtx.currentTime + 0.1);
}

function playWin() {
  const freqs = [523.25, 659.25, 783.99];
  freqs.forEach((f, i) => {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.frequency.setValueAtTime(f, audioCtx.currentTime + (i * 0.1));
    gain.gain.setValueAtTime(0.05, audioCtx.currentTime + (i * 0.1));
    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
    osc.connect(gain); gain.connect(audioCtx.destination);
    osc.start(); osc.stop(audioCtx.currentTime + 0.5);
  });
}

function drawWheel() {
  const radius = canvas.width / 2;
  const slice = (2 * Math.PI) / items.length;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  items.forEach((item, i) => {
    const angle = currentAngle + i * slice;
    ctx.beginPath();
    ctx.moveTo(radius, radius);
    ctx.arc(radius, radius, radius - 10, angle, angle + slice);
    ctx.fillStyle = colors[i];
    ctx.fill();
    ctx.strokeStyle = "rgba(255,255,255,0.2)";
    ctx.lineWidth = 1;
    ctx.stroke();

    ctx.save();
    ctx.translate(radius, radius);
    ctx.rotate(angle + slice / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = i % 2 === 0 ? "white" : "#003a8f";
    ctx.font = "bold 15px Inter";
    ctx.fillText(item, radius - 40, 6);
    ctx.restore();
  });
}

drawWheel();

function openWheel() {
  wheelOverlay.classList.add('active');
}

spinBtn.addEventListener("click", () => {
  if (isSpinning) return;
  if (audioCtx.state === 'suspended') audioCtx.resume();

  isSpinning = true;
  spinBtn.disabled = true;
  resultBox.textContent = "SPINNING...";

  const spinDuration = 5000;
  const startAngle = currentAngle;
  const totalSpins = (Math.PI * 2 * 9) + (Math.random() * Math.PI * 2);
  const startTime = performance.now();

  function animate(now) {
    const p = Math.min((now - startTime) / spinDuration, 1);
    const ease = 1 - Math.pow(1 - p, 3);
    currentAngle = startAngle + totalSpins * ease;

    const slice = (2 * Math.PI) / items.length;
    const currentTick = Math.floor((currentAngle % (Math.PI * 2)) / slice);
    if (currentTick !== lastTickIndex) {
      playTick();
      lastTickIndex = currentTick;
    }

    drawWheel();

    if (p < 1) requestAnimationFrame(animate);
    else finalize();
  }
  requestAnimationFrame(animate);
});

function finalize() {
  isSpinning = false;
  spinBtn.disabled = false;

  const slice = (2 * Math.PI) / items.length;
  const winningIndex = items.length - 1 - Math.floor(((currentAngle + Math.PI/2) % (Math.PI * 2)) / slice);
  const result = items[winningIndex >= 0 ? winningIndex : 0];

  resultBox.textContent = result.toUpperCase();

  let earned = 0;
  if (!result.includes("Try") && !result.includes("Luck")) {
    earned = parseInt(result);
    playWin();
  }

  let totalPoints = parseInt(localStorage.getItem('niq_points') || '0');
  totalPoints += earned;
  localStorage.setItem('niq_points', totalPoints);
  document.getElementById('metricPoints').textContent = totalPoints;

  localStorage.setItem('niq_spin_done', 'true');

  setTimeout(() => {
    wheelOverlay.classList.remove('active');
  }, 2500);
}
</script>
</body>
</html>
